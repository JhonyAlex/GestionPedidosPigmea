2026-01-30T00:54:14.631Z âœ… Tabla vendedores creada
2026-01-30T00:54:14.636Z âœ… Ãndices verificados
2026-01-30T00:54:14.643Z âœ… Triggers configurados
2026-01-30T00:54:14.653Z âœ… Columna vendedor_id verificada/creada
2026-01-30T00:54:14.653Z ğŸ‰ Todas las tablas han sido verificadas/creadas exitosamente
2026-01-30T00:54:14.664Z ğŸš€ Servidor iniciado en puerto 3001
2026-01-30T00:54:14.664Z âœ… PostgreSQL conectado - Sistema operativo
2026-01-30T00:57:36.887Z ğŸ“¨ [1] GET /api/pedidos - User: b24fa21c-f2b2-4034-b10c-c0e65c09019e - 2026-01-30T00:57:36.885Z
2026-01-30T00:57:36.917Z ğŸ“Š [2026-01-30T00:57:36.917Z] GET /api/pedidos (LEGACY) - Total: 2 pedidos
2026-01-30T00:57:37.062Z ğŸ“¨ [2] GET /api/audit - User: b24fa21c-f2b2-4034-b10c-c0e65c09019e - 2026-01-30T00:57:37.062Z
2026-01-30T00:57:37.067Z ğŸ“¨ [3] GET /api/notifications - User: b24fa21c-f2b2-4034-b10c-c0e65c09019e - 2026-01-30T00:57:37.065Z
2026-01-30T00:57:37.080Z ğŸ“¨ [4] GET /api/notifications - User: b24fa21c-f2b2-4034-b10c-c0e65c09019e - 2026-01-30T00:57:37.078Z
2026-01-30T00:57:37.080Z ğŸ“¨ [5] GET /api/vendedores - User: b24fa21c-f2b2-4034-b10c-c0e65c09019e - 2026-01-30T00:57:37.079Z
2026-01-30T00:57:37.082Z ğŸ” Verificando permiso 'vendedores.view' para usuario ID: b24fa21c-f2b2-4034-b10c-c0e65c09019e
2026-01-30T00:57:37.082Z ğŸ‘‘ Usuario administrador - TODOS LOS PERMISOS CONCEDIDOS
2026-01-30T00:57:37.084Z ğŸ“¨ [6] GET /api/clientes/simple - User: b24fa21c-f2b2-4034-b10c-c0e65c09019e - 2026-01-30T00:57:37.083Z
2026-01-30T00:57:37.086Z ğŸ” Verificando permiso 'clientes.view' para usuario ID: b24fa21c-f2b2-4034-b10c-c0e65c09019e
2026-01-30T00:57:37.086Z ğŸ‘‘ Usuario administrador - TODOS LOS PERMISOS CONCEDIDOS
2026-01-30T00:57:37.132Z ğŸ”— Nueva conexiÃ³n al pool establecida
2026-01-30T00:57:37.138Z ğŸ”— Nueva conexiÃ³n al pool establecida
2026-01-30T00:57:37.139Z ğŸ”— Nueva conexiÃ³n al pool establecida
2026-01-30T00:57:37.146Z ğŸ“Š [getAllClientesSimple] Total clientes encontrados: 1
2026-01-30T00:57:37.321Z ğŸ“¨ [7] GET /api/materiales - User: b24fa21c-f2b2-4034-b10c-c0e65c09019e - 2026-01-30T00:57:37.320Z
2026-01-30T00:57:37.329Z âœ… Materiales obtenidos: 0
2026-01-30T00:57:38.807Z ğŸ“¨ [8] GET /api/comments/1769733842532 - User: b24fa21c-f2b2-4034-b10c-c0e65c09019e - 2026-01-30T00:57:38.807Z
2026-01-30T00:57:38.838Z ğŸ”’ Pedido 1769733842532 bloqueado por Jhony Admin (b24fa21c-f2b2-4034-b10c-c0e65c09019e)
2026-01-30T00:57:39.008Z ğŸ“¨ [9] GET /api/observaciones/templates - User: b24fa21c-f2b2-4034-b10c-c0e65c09019e - 2026-01-30T00:57:39.008Z
2026-01-30T00:57:39.012Z ğŸ“¨ [10] GET /api/users/active - User: b24fa21c-f2b2-4034-b10c-c0e65c09019e - 2026-01-30T00:57:39.010Z
2026-01-30T00:57:39.013Z ğŸ“¨ [11] GET /api/vendedores - User: b24fa21c-f2b2-4034-b10c-c0e65c09019e - 2026-01-30T00:57:39.013Z
2026-01-30T00:57:39.015Z ğŸ” Verificando permiso 'vendedores.view' para usuario ID: b24fa21c-f2b2-4034-b10c-c0e65c09019e
2026-01-30T00:57:39.017Z ğŸ‘‘ Usuario administrador - TODOS LOS PERMISOS CONCEDIDOS
2026-01-30T00:57:39.017Z ğŸ“¨ [12] GET /api/pedidos/1769733842532/materiales - User: b24fa21c-f2b2-4034-b10c-c0e65c09019e - 2026-01-30T00:57:39.016Z
2026-01-30T00:57:39.018Z ğŸ“¨ [13] GET /api/clientes/simple - User: b24fa21c-f2b2-4034-b10c-c0e65c09019e - 2026-01-30T00:57:39.018Z
2026-01-30T00:57:39.019Z ğŸ” Verificando permiso 'clientes.view' para usuario ID: b24fa21c-f2b2-4034-b10c-c0e65c09019e
2026-01-30T00:57:39.019Z ğŸ‘‘ Usuario administrador - TODOS LOS PERMISOS CONCEDIDOS
2026-01-30T00:57:39.026Z ğŸ“¦ GET /api/pedidos/1769733842532/materiales â†’ 0 materiales encontrados
2026-01-30T00:57:39.054Z ğŸ”— Nueva conexiÃ³n al pool establecida
2026-01-30T00:57:39.062Z ğŸ“Š [getAllClientesSimple] Total clientes encontrados: 1
2026-01-30T00:57:54.205Z ğŸ“¨ [14] POST /api/vendedores - User: b24fa21c-f2b2-4034-b10c-c0e65c09019e - 2026-01-30T00:57:54.205Z
2026-01-30T00:57:54.208Z ğŸ” requirePermission middleware
2026-01-30T00:57:54.208Z - Ruta: POST /api/vendedores
2026-01-30T00:57:54.208Z - Permiso requerido: vendedores.create
2026-01-30T00:57:54.208Z - Usuario: b24fa21c-f2b2-4034-b10c-c0e65c09019e (ADMIN)
2026-01-30T00:57:54.211Z - Headers: {
2026-01-30T00:57:54.211Z userId: 'b24fa21c-f2b2-4034-b10c-c0e65c09019e',
2026-01-30T00:57:54.211Z userRole: 'Administrador'
2026-01-30T00:57:54.211Z }
2026-01-30T00:57:54.212Z - Permisos a verificar (incluyendo aliases): [ 'vendedores.create' ]
2026-01-30T00:57:54.212Z - Verificando permiso en BD...
2026-01-30T00:57:54.212Z ğŸ” Verificando permiso 'vendedores.create' para usuario ID: b24fa21c-f2b2-4034-b10c-c0e65c09019e
2026-01-30T00:57:54.212Z ğŸ‘‘ Usuario administrador - TODOS LOS PERMISOS CONCEDIDOS
2026-01-30T00:57:54.212Z - âœ… Usuario tiene permiso: vendedores.create
2026-01-30T00:57:54.212Z - Resultado: âœ… PERMITIDO
2026-01-30T00:57:54.212Z âœ… Permiso concedido - continuando con la request
2026-01-30T00:57:54.222Z âŒ Error registrando historial de vendedor: insert or update on table "vendedores_history" violates foreign key constraint "vendedores_history_vendedor_id_fkey"
2026-01-30T00:57:58.218Z ğŸ“¨ [15] POST /api/action-history - User: anonymous - 2026-01-30T00:57:58.218Z
2026-01-30T00:57:58.228Z âœ… Historial guardado: pedido 1769733842532 - UPDATE
2026-01-30T00:57:58.592Z ğŸ”“ Pedido 1769733842532 desbloqueado por Jhony Admin
2026-01-30T00:57:58.600Z ğŸ“¨ [16] PUT /api/pedidos/1769733842532 - User: b24fa21c-f2b2-4034-b10c-c0e65c09019e - 2026-01-30T00:57:58.600Z
2026-01-30T00:57:58.601Z ğŸ” requirePermission middleware
2026-01-30T00:57:58.601Z - Ruta: PUT /api/pedidos/1769733842532
2026-01-30T00:57:58.601Z - Permiso requerido: pedidos.edit
2026-01-30T00:57:58.601Z - Usuario: b24fa21c-f2b2-4034-b10c-c0e65c09019e (ADMIN)
2026-01-30T00:57:58.602Z - Headers: {
2026-01-30T00:57:58.602Z userId: 'b24fa21c-f2b2-4034-b10c-c0e65c09019e',
2026-01-30T00:57:58.602Z userRole: 'Administrador'
2026-01-30T00:57:58.603Z }
2026-01-30T00:57:58.603Z - Permisos a verificar (incluyendo aliases): [ 'pedidos.edit', 'vista.pedidos' ]
2026-01-30T00:57:58.603Z - Verificando permiso en BD...
2026-01-30T00:57:58.603Z ğŸ” Verificando permiso 'pedidos.edit' para usuario ID: b24fa21c-f2b2-4034-b10c-c0e65c09019e
2026-01-30T00:57:58.603Z ğŸ‘‘ Usuario administrador - TODOS LOS PERMISOS CONCEDIDOS
2026-01-30T00:57:58.603Z - âœ… Usuario tiene permiso: pedidos.edit
2026-01-30T00:57:58.603Z - Resultado: âœ… PERMITIDO
2026-01-30T00:57:58.603Z âœ… Permiso concedido - continuando con la request
2026-01-30T00:57:58.608Z âš ï¸ Vendedor 70b9f839-4293-4cc4-9884-0f1a98b40eca no encontrado. Estableciendo vendedorId como null.
2026-01-30T00:57:58.625Z ğŸ”„ Actualizando pedido 1769733842532 con columnas disponibles: nueva_fecha_entrega=true, numeros_compra=true, vendedor=true, cliche_info=false, anonimo=true
2026-01-30T00:57:58.636Z Error updating pedido 1769733842532: error: column "cantidad_piezas" of relation "pedidos" does not exist
2026-01-30T00:57:58.636Z at /app/backend/node_modules/pg/lib/client.js:545:17
2026-01-30T00:57:58.636Z at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
2026-01-30T00:57:58.636Z at async PostgreSQLClient.update (/app/backend/postgres-client.js:1423:28)
2026-01-30T00:57:58.636Z at async /app/backend/index.js:2883:9 {
2026-01-30T00:57:58.636Z length: 138,
2026-01-30T00:57:58.636Z severity: 'ERROR',
2026-01-30T00:57:58.636Z code: '42703',
2026-01-30T00:57:58.636Z detail: undefined,
2026-01-30T00:57:58.636Z hint: undefined,
2026-01-30T00:57:58.636Z position: '211',
2026-01-30T00:57:58.636Z internalPosition: undefined,
2026-01-30T00:57:58.636Z internalQuery: undefined,
2026-01-30T00:57:58.636Z where: undefined,
2026-01-30T00:57:58.636Z schema: undefined,
2026-01-30T00:57:58.636Z table: undefined,
2026-01-30T00:57:58.636Z column: undefined,
2026-01-30T00:57:58.636Z dataType: undefined,
2026-01-30T00:57:58.636Z constraint: undefined,
2026-01-30T00:57:58.636Z file: 'analyze.c',
2026-01-30T00:57:58.636Z line: '2515',
2026-01-30T00:57:58.636Z routine: 'transformUpdateTargetList'
2026-01-30T00:57:58.636Z }